stat="identity",
stat_params=list(),
geom="text",
geom_params=list(colour="black", hjust=-0.5, size=3.5),
position=position_identity()
) +
layer(data=dfb,
mapping=aes(x=Y, y=AVG_CAMPAIGN, label=round(WINDOW_AVG_CAMPAIGN, 4)),
stat="identity",
stat_params=list(),
geom="text",
geom_params=list(colour="black", hjust=-2, size=3.5),
position=position_identity()
) +
layer(data=dfb,
mapping=aes(x=Y, y=AVG_CAMPAIGN, label=round(AVG_CAMPAIGN - WINDOW_AVG_CAMPAIGN, 4)),
stat="identity",
stat_params=list(),
geom="text",
geom_params=list(colour="black", hjust=-5, size=3.5),
position=position_identity()
) +
layer(data=dfb,
mapping=aes(yintercept = WINDOW_AVG_CAMPAIGN),
geom="hline",
geom_params=list(colour="red")
)
require(tidyr)
require(dplyr)
require(extrafont)
require(ggplot2)
dfb <- df %>% group_by(POUTCOME, Y) %>% summarise(AVG_CAMPAIGN = mean(CAMPAIGN))
dfb1 <- dfb %>% ungroup %>% group_by(POUTCOME) %>% summarise(WINDOW_AVG_CAMPAIGN = mean(AVG_CAMPAIGN))
dfb <- inner_join(dfb, dfb1, by="POUTCOME")
#spread(dfb, Y, AVG_CAMPAIGN) %>% View
ggplot() +
coord_cartesian(xlim = c(0, 5)) +
scale_x_discrete() +
scale_y_continuous() +
facet_wrap(~POUTCOME, ncol=1) +
labs(title='Portuguese Bank Marketing Campaign Effectiveness\nScatter Plot\nAVG_CAMPAIGN, WINDOW_AVG_CAMPAIGN') +
labs(x=paste("Y (OUTCOME)"), y=paste("AVG_CAMPAIGN")) +
layer(data=dfb,
mapping=aes(x=Y, y=AVG_CAMPAIGN, color=Y, fill=Y),
stat="identity",
stat_params=list(),
geom="bar",
geom_params=list(width=.25),
position=position_identity()
) + coord_flip() +
layer(data=dfb,
mapping=aes(x=Y, y=AVG_CAMPAIGN, label=round(AVG_CAMPAIGN, 4)),
stat="identity",
stat_params=list(),
geom="text",
geom_params=list(colour="black", hjust=-0.5, size=3.5),
position=position_identity()
) +
layer(data=dfb,
mapping=aes(x=Y, y=AVG_CAMPAIGN, label=round(WINDOW_AVG_CAMPAIGN, 4)),
stat="identity",
stat_params=list(),
geom="text",
geom_params=list(colour="black", hjust=-2, size=3.5),
position=position_identity()
) +
layer(data=dfb,
mapping=aes(x=Y, y=AVG_CAMPAIGN, label=round(AVG_CAMPAIGN - WINDOW_AVG_CAMPAIGN, 4)),
stat="identity",
stat_params=list(),
geom="text",
geom_params=list(colour="black", hjust=-5, size=3.5),
position=position_identity()
) +
layer(data=dfb,
mapping=aes(yintercept = WINDOW_AVG_CAMPAIGN),
geom="hline",
geom_params=list(colour="red")
)
require(tidyr)
require(dplyr)
require(extrafont)
require(ggplot2)
dfb <- df %>% group_by(POUTCOME, Y) %>% summarise(AVG_CAMPAIGN = mean(CAMPAIGN))
dfb1 <- dfb %>% ungroup %>% group_by(POUTCOME) %>% summarise(WINDOW_AVG_CAMPAIGN = mean(AVG_CAMPAIGN))
dfb <- inner_join(dfb, dfb1, by="POUTCOME")
#spread(dfb, Y, AVG_CAMPAIGN) %>% View
ggplot() +
coord_cartesian(xlim = c(0, 5)) +
scale_x_discrete() +
scale_y_continuous() +
facet_wrap(~POUTCOME, ncol=3) +
labs(title='Portuguese Bank Marketing Campaign Effectiveness\nScatter Plot\nAVG_CAMPAIGN, WINDOW_AVG_CAMPAIGN') +
labs(x=paste("Y (OUTCOME)"), y=paste("AVG_CAMPAIGN")) +
layer(data=dfb,
mapping=aes(x=Y, y=AVG_CAMPAIGN, color=Y, fill=Y),
stat="identity",
stat_params=list(),
geom="bar",
geom_params=list(width=.25),
position=position_identity()
) + coord_flip() +
layer(data=dfb,
mapping=aes(x=Y, y=AVG_CAMPAIGN, label=round(AVG_CAMPAIGN, 4)),
stat="identity",
stat_params=list(),
geom="text",
geom_params=list(colour="black", hjust=-0.5, size=3.5),
position=position_identity()
) +
layer(data=dfb,
mapping=aes(x=Y, y=AVG_CAMPAIGN, label=round(WINDOW_AVG_CAMPAIGN, 4)),
stat="identity",
stat_params=list(),
geom="text",
geom_params=list(colour="black", hjust=-2, size=3.5),
position=position_identity()
) +
layer(data=dfb,
mapping=aes(x=Y, y=AVG_CAMPAIGN, label=round(AVG_CAMPAIGN - WINDOW_AVG_CAMPAIGN, 4)),
stat="identity",
stat_params=list(),
geom="text",
geom_params=list(colour="black", hjust=-5, size=3.5),
position=position_identity()
) +
layer(data=dfb,
mapping=aes(yintercept = WINDOW_AVG_CAMPAIGN),
geom="hline",
geom_params=list(colour="red")
)
require(tidyr)
require(dplyr)
require(extrafont)
require(ggplot2)
dfb <- df %>% group_by(POUTCOME, Y) %>% summarise(AVG_CAMPAIGN = mean(CAMPAIGN))
dfb1 <- dfb %>% ungroup %>% group_by(POUTCOME) %>% summarise(WINDOW_AVG_CAMPAIGN = mean(AVG_CAMPAIGN))
dfb <- inner_join(dfb, dfb1, by="POUTCOME")
#spread(dfb, Y, AVG_CAMPAIGN) %>% View
ggplot() +
coord_cartesian(xlim = c(0, 5)) +
scale_x_discrete() +
scale_y_continuous() +
facet_wrap(~POUTCOME, ncol=100) +
labs(title='Portuguese Bank Marketing Campaign Effectiveness\nScatter Plot\nAVG_CAMPAIGN, WINDOW_AVG_CAMPAIGN') +
labs(x=paste("Y (OUTCOME)"), y=paste("AVG_CAMPAIGN")) +
layer(data=dfb,
mapping=aes(x=Y, y=AVG_CAMPAIGN, color=Y, fill=Y),
stat="identity",
stat_params=list(),
geom="bar",
geom_params=list(width=.25),
position=position_identity()
) + coord_flip() +
layer(data=dfb,
mapping=aes(x=Y, y=AVG_CAMPAIGN, label=round(AVG_CAMPAIGN, 4)),
stat="identity",
stat_params=list(),
geom="text",
geom_params=list(colour="black", hjust=-0.5, size=3.5),
position=position_identity()
) +
layer(data=dfb,
mapping=aes(x=Y, y=AVG_CAMPAIGN, label=round(WINDOW_AVG_CAMPAIGN, 4)),
stat="identity",
stat_params=list(),
geom="text",
geom_params=list(colour="black", hjust=-2, size=3.5),
position=position_identity()
) +
layer(data=dfb,
mapping=aes(x=Y, y=AVG_CAMPAIGN, label=round(AVG_CAMPAIGN - WINDOW_AVG_CAMPAIGN, 4)),
stat="identity",
stat_params=list(),
geom="text",
geom_params=list(colour="black", hjust=-5, size=3.5),
position=position_identity()
) +
layer(data=dfb,
mapping=aes(yintercept = WINDOW_AVG_CAMPAIGN),
geom="hline",
geom_params=list(colour="red")
)
require(tidyr)
require(dplyr)
require(extrafont)
require(ggplot2)
dfb <- df %>% group_by(POUTCOME, Y) %>% summarise(AVG_CAMPAIGN = mean(CAMPAIGN))
dfb1 <- dfb %>% ungroup %>% group_by(POUTCOME) %>% summarise(WINDOW_AVG_CAMPAIGN = mean(AVG_CAMPAIGN))
dfb <- inner_join(dfb, dfb1, by="POUTCOME")
#spread(dfb, Y, AVG_CAMPAIGN) %>% View
ggplot() +
coord_cartesian() +
scale_x_discrete() +
scale_y_continuous() +
facet_wrap(~POUTCOME, ncol=1) +
labs(title='Portuguese Bank Marketing Campaign Effectiveness\nScatter Plot\nAVG_CAMPAIGN, WINDOW_AVG_CAMPAIGN') +
labs(x=paste("Y (OUTCOME)"), y=paste("AVG_CAMPAIGN")) +
layer(data=dfb,
mapping=aes(x=Y, y=AVG_CAMPAIGN, color=Y, fill=Y),
stat="identity",
stat_params=list(),
geom="bar",
geom_params=list(width=.25),
position=position_identity()
) + coord_flip() +
layer(data=dfb,
mapping=aes(x=Y, y=AVG_CAMPAIGN, label=round(AVG_CAMPAIGN, 4)),
stat="identity",
stat_params=list(),
geom="text",
geom_params=list(colour="black", hjust=-0.5, size=3.5),
position=position_identity()
) +
layer(data=dfb,
mapping=aes(x=Y, y=AVG_CAMPAIGN, label=round(WINDOW_AVG_CAMPAIGN, 4)),
stat="identity",
stat_params=list(),
geom="text",
geom_params=list(colour="black", hjust=-2, size=3.5),
position=position_identity()
) +
layer(data=dfb,
mapping=aes(x=Y, y=AVG_CAMPAIGN, label=round(AVG_CAMPAIGN - WINDOW_AVG_CAMPAIGN, 4)),
stat="identity",
stat_params=list(),
geom="text",
geom_params=list(colour="black", hjust=-5, size=3.5),
position=position_identity()
) +
layer(data=dfb,
mapping=aes(yintercept = WINDOW_AVG_CAMPAIGN),
geom="hline",
geom_params=list(colour="red")
)
require("jsonlite")
require("RCurl")
require(ggplot2)
require(dplyr)
# The following is equivalent to KPI Story 2 Sheet 2 and Parameters Story 3 in "Crosstabs, KPIs, Barchart.twb"
# These will be made to more resemble Tableau Parameters when we study Shiny.
KPI_Low_Max_value = 4750
KPI_Medium_Max_value = 5000
df <- data.frame(fromJSON(getURL(URLencode(gsub("\n", " ", 'skipper.cs.utexas.edu:5001/rest/native/?query=
"select color, clarity, sum_price, round(sum_carat) as sum_carat, kpi as ratio,
case
when kpi < "p1" then \\\'03 Low\\\'
when kpi < "p2" then \\\'02 Medium\\\'
else \\\'01 High\\\'
end kpi
from (select color, clarity,
sum(price) as sum_price, sum(carat) as sum_carat,
sum(price) / sum(carat) as kpi
from diamonds
group by color, clarity)
order by clarity;"
')), httpheader=c(DB='jdbc:oracle:thin:@sayonara.microlab.cs.utexas.edu:1521:orcl', USER='C##cs329e_UTEid', PASS='orcl_UTEid', MODE='native_mode', MODEL='model', returnDimensions = 'False', returnFor = 'JSON', p1=KPI_Low_Max_value, p2=KPI_Medium_Max_value), verbose = TRUE))); View(df)
# df <- diamonds %>% group_by(color, clarity) %>% summarize(sum_price = sum(price), sum_carat = sum(carat)) %>% mutate(ratio = sum_price / sum_carat) %>% mutate(kpi = ifelse(ratio <= KPI_Low_Max_value, '03 Low', ifelse(ratio <= KPI_Medium_Max_value, '02 Medium', '01 High'))) %>% rename(COLOR=color, CLARITY=clarity, SUM_PRICE=sum_price, SUM_CARAT=sum_carat, RATIO=ratio, KPI=kpi)
spread(df, COLOR, SUM_PRICE) %>% View
ggplot() +
coord_cartesian() +
scale_x_discrete() +
scale_y_discrete() +
labs(title='Diamonds Crosstab\nSUM_PRICE, SUM_CARAT, SUM_PRICE / SUM_CARAT') +
labs(x=paste("COLOR"), y=paste("CLARITY")) +
layer(data=df,
mapping=aes(x=COLOR, y=CLARITY, label=SUM_PRICE),
stat="identity",
stat_params=list(),
geom="text",
geom_params=list(colour="black"),
position=position_identity()
) +
layer(data=df,
mapping=aes(x=COLOR, y=CLARITY, label=SUM_CARAT),
stat="identity",
stat_params=list(),
geom="text",
geom_params=list(colour="black", vjust=2),
position=position_identity()
) +
layer(data=df,
mapping=aes(x=COLOR, y=CLARITY, label=round(RATIO, 2)),
stat="identity",
stat_params=list(),
geom="text",
geom_params=list(colour="black", vjust=4),
position=position_identity()
) +
layer(data=df,
mapping=aes(x=COLOR, y=CLARITY, fill=KPI),
stat="identity",
stat_params=list(),
geom="tile",
geom_params=list(alpha=0.50),
position=position_identity()
)
require(tidyr)
require(dplyr)
require(extrafont)
require(ggplot2)
dfb <- df %>% group_by(POUTCOME, Y) %>% summarise(AVG_CAMPAIGN = mean(CAMPAIGN))
dfb1 <- dfb %>% ungroup %>% group_by(POUTCOME) %>% summarise(WINDOW_AVG_CAMPAIGN = mean(AVG_CAMPAIGN))
dfb <- inner_join(dfb, dfb1, by="POUTCOME")
#spread(dfb, Y, AVG_CAMPAIGN) %>% View
ggplot() +
coord_cartesian() +
scale_x_discrete() +
scale_y_continuous() +
facet_wrap(~POUTCOME, ncol=1) +
labs(title='Portuguese Bank Marketing Campaign Effectiveness\Bar Chart\nAVG_CAMPAIGN, WINDOW_AVG_CAMPAIGN') +
labs(x=paste("Y (OUTCOME)"), y=paste("AVG_CAMPAIGN")) +
layer(data=dfb,
mapping=aes(x=Y, y=AVG_CAMPAIGN, color=Y, fill=Y),
stat="identity",
stat_params=list(),
geom="bar",
geom_params=list(width=.25),
position=position_identity()
) + coord_flip() +
layer(data=dfb,
mapping=aes(x=Y, y=AVG_CAMPAIGN, label=round(AVG_CAMPAIGN, 4)),
stat="identity",
stat_params=list(),
geom="text",
geom_params=list(colour="black", hjust=-0.5, size=3.5),
position=position_identity()
) +
layer(data=dfb,
mapping=aes(x=Y, y=AVG_CAMPAIGN, label=round(WINDOW_AVG_CAMPAIGN, 4)),
stat="identity",
stat_params=list(),
geom="text",
geom_params=list(colour="black", hjust=-2, size=3.5),
position=position_identity()
) +
layer(data=dfb,
mapping=aes(x=Y, y=AVG_CAMPAIGN, label=round(AVG_CAMPAIGN - WINDOW_AVG_CAMPAIGN, 4)),
stat="identity",
stat_params=list(),
geom="text",
geom_params=list(colour="black", hjust=-5, size=3.5),
position=position_identity()
) +
layer(data=dfb,
mapping=aes(yintercept = WINDOW_AVG_CAMPAIGN),
geom="hline",
geom_params=list(colour="red")
)
require("jsonlite")
require("RCurl")
#Gather data from database fill into local data frame and retrieve headers and summary
# Change the USER and PASS below to be your UTEid
df <- data.frame(fromJSON(getURL(URLencode('skipper.cs.utexas.edu:5001/rest/native/?query="select * from BNKMKTG"'),httpheader=c(DB='jdbc:oracle:thin:@sayonara.microlab.cs.utexas.edu:1521:orcl', USER='C##cs329e_rm46926', PASS='orcl_rm46926', MODE='native_mode', MODEL='model', returnDimensions = 'False', returnFor = 'JSON'), verbose = TRUE), ))
head(df)
summary(df)
require(tidyr)
require(dplyr)
require(extrafont)
require(ggplot2)
dfb <- df %>% group_by(POUTCOME, Y) %>% summarise(AVG_CAMPAIGN = mean(CAMPAIGN))
dfb1 <- dfb %>% ungroup %>% group_by(POUTCOME) %>% summarise(WINDOW_AVG_CAMPAIGN = mean(AVG_CAMPAIGN))
dfb <- inner_join(dfb, dfb1, by="POUTCOME")
#spread(dfb, Y, AVG_CAMPAIGN) %>% View
ggplot() +
coord_cartesian() +
scale_x_discrete() +
scale_y_continuous() +
facet_wrap(~POUTCOME, ncol=1) +
labs(title='Portuguese Bank Marketing Campaign Effectiveness\Bar Chart\nAVG_CAMPAIGN, WINDOW_AVG_CAMPAIGN') +
labs(x=paste("Y (OUTCOME)"), y=paste("AVG_CAMPAIGN")) +
layer(data=dfb,
mapping=aes(x=Y, y=AVG_CAMPAIGN, color=Y, fill=Y),
stat="identity",
stat_params=list(),
geom="bar",
geom_params=list(width=.25),
position=position_identity()
) + coord_flip() +
layer(data=dfb,
mapping=aes(x=Y, y=AVG_CAMPAIGN, label=round(AVG_CAMPAIGN, 4)),
stat="identity",
stat_params=list(),
geom="text",
geom_params=list(colour="black", hjust=-0.5, size=3.5),
position=position_identity()
) +
layer(data=dfb,
mapping=aes(x=Y, y=AVG_CAMPAIGN, label=round(WINDOW_AVG_CAMPAIGN, 4)),
stat="identity",
stat_params=list(),
geom="text",
geom_params=list(colour="black", hjust=-2, size=3.5),
position=position_identity()
) +
layer(data=dfb,
mapping=aes(x=Y, y=AVG_CAMPAIGN, label=round(AVG_CAMPAIGN - WINDOW_AVG_CAMPAIGN, 4)),
stat="identity",
stat_params=list(),
geom="text",
geom_params=list(colour="black", hjust=-5, size=3.5),
position=position_identity()
) +
layer(data=dfb,
mapping=aes(yintercept = WINDOW_AVG_CAMPAIGN),
geom="hline",
geom_params=list(colour="red")
)
require(tidyr)
require(dplyr)
require(extrafont)
require(ggplot2)
dfb <- df %>% group_by(POUTCOME, Y) %>% summarise(AVG_CAMPAIGN = mean(CAMPAIGN))
dfb1 <- dfb %>% ungroup %>% group_by(POUTCOME) %>% summarise(WINDOW_AVG_CAMPAIGN = mean(AVG_CAMPAIGN))
dfb <- inner_join(dfb, dfb1, by="POUTCOME")
#spread(dfb, Y, AVG_CAMPAIGN) %>% View
ggplot() +
coord_cartesian() +
scale_x_discrete() +
scale_y_continuous() +
facet_wrap(~POUTCOME, ncol=1) +
labs(title='Portuguese Bank Marketing Campaign Effectiveness\nScatter Plot\nAVG_CAMPAIGN, WINDOW_AVG_CAMPAIGN') +
labs(x=paste("Y (OUTCOME)"), y=paste("AVG_CAMPAIGN")) +
layer(data=dfb,
mapping=aes(x=Y, y=AVG_CAMPAIGN, color=Y, fill=Y),
stat="identity",
stat_params=list(),
geom="bar",
geom_params=list(width=.25),
position=position_identity()
) + coord_flip() +
layer(data=dfb,
mapping=aes(x=Y, y=AVG_CAMPAIGN, label=round(AVG_CAMPAIGN, 4)),
stat="identity",
stat_params=list(),
geom="text",
geom_params=list(colour="black", hjust=-0.5, size=3.5),
position=position_identity()
) +
layer(data=dfb,
mapping=aes(x=Y, y=AVG_CAMPAIGN, label=round(WINDOW_AVG_CAMPAIGN, 4)),
stat="identity",
stat_params=list(),
geom="text",
geom_params=list(colour="black", hjust=-2, size=3.5),
position=position_identity()
) +
layer(data=dfb,
mapping=aes(x=Y, y=AVG_CAMPAIGN, label=round(AVG_CAMPAIGN - WINDOW_AVG_CAMPAIGN, 4)),
stat="identity",
stat_params=list(),
geom="text",
geom_params=list(colour="black", hjust=-5, size=3.5),
position=position_identity()
) +
layer(data=dfb,
mapping=aes(yintercept = WINDOW_AVG_CAMPAIGN),
geom="hline",
geom_params=list(colour="red")
)
require(tidyr)
require(dplyr)
require(extrafont)
require(ggplot2)
dfb <- df %>% group_by(POUTCOME, Y) %>% summarise(AVG_CAMPAIGN = mean(CAMPAIGN))
dfb1 <- dfb %>% ungroup %>% group_by(POUTCOME) %>% summarise(WINDOW_AVG_CAMPAIGN = mean(AVG_CAMPAIGN))
dfb <- inner_join(dfb, dfb1, by="POUTCOME")
#spread(dfb, Y, AVG_CAMPAIGN) %>% View
ggplot() +
coord_cartesian() +
scale_x_discrete() +
scale_y_continuous() +
facet_wrap(~POUTCOME, ncol=1) +
labs(title='Portuguese Bank Marketing Campaign Effectiveness\nBar Chart\nAVG_CAMPAIGN, WINDOW_AVG_CAMPAIGN') +
labs(x=paste("Y (OUTCOME)"), y=paste("AVG_CAMPAIGN")) +
layer(data=dfb,
mapping=aes(x=Y, y=AVG_CAMPAIGN, color=Y, fill=Y),
stat="identity",
stat_params=list(),
geom="bar",
geom_params=list(width=.25),
position=position_identity()
) + coord_flip() +
layer(data=dfb,
mapping=aes(x=Y, y=AVG_CAMPAIGN, label=round(AVG_CAMPAIGN, 4)),
stat="identity",
stat_params=list(),
geom="text",
geom_params=list(colour="black", hjust=-0.5, size=3.5),
position=position_identity()
) +
layer(data=dfb,
mapping=aes(x=Y, y=AVG_CAMPAIGN, label=round(WINDOW_AVG_CAMPAIGN, 4)),
stat="identity",
stat_params=list(),
geom="text",
geom_params=list(colour="black", hjust=-2, size=3.5),
position=position_identity()
) +
layer(data=dfb,
mapping=aes(x=Y, y=AVG_CAMPAIGN, label=round(AVG_CAMPAIGN - WINDOW_AVG_CAMPAIGN, 4)),
stat="identity",
stat_params=list(),
geom="text",
geom_params=list(colour="black", hjust=-5, size=3.5),
position=position_identity()
) +
layer(data=dfb,
mapping=aes(yintercept = WINDOW_AVG_CAMPAIGN),
geom="hline",
geom_params=list(colour="red")
)
