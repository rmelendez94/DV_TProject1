position=position_identity()
)
require(tidyr)
require(dplyr)
require(extrafont)
require(ggplot2)
dfb <- df %>% group_by(POUTCOME, Y) %>% summarise(AVG_CAMPAIGN = mean(CAMPAIGN))
dfb1 <- dfb %>% ungroup %>% group_by(POUTCOME) %>% summarise(WINDOW_AVG_CAMPAIGN = mean(AVG_CAMPAIGN))
dfb <- inner_join(dfb, dfb1, by="POUTCOME")
#spread(dfb, Y, AVG_CAMPAIGN) %>% View
ggplot() +
coord_cartesian() +
scale_x_discrete() +
scale_y_continuous() +
facet_wrap(~POUTCOME, ncol=1) +
labs(title='Portuguese Bank Marketing Campaign Effectiveness\Bar Chart\nAVG_CAMPAIGN, WINDOW_AVG_CAMPAIGN') +
labs(x=paste("Y (OUTCOME)"), y=paste("AVG_CAMPAIGN")) +
layer(data=dfb,
mapping=aes(x=Y, y=AVG_CAMPAIGN, color=Y, fill=Y),
stat="identity",
stat_params=list(),
geom="bar",
geom_params=list(width=.25),
position=position_identity()
) + coord_flip() +
layer(data=dfb,
mapping=aes(x=Y, y=AVG_CAMPAIGN, label=round(AVG_CAMPAIGN, 4)),
stat="identity",
stat_params=list(),
geom="text",
geom_params=list(colour="black", hjust=-0.5, size=3.5),
position=position_identity()
) +
layer(data=dfb,
mapping=aes(x=Y, y=AVG_CAMPAIGN, label=round(WINDOW_AVG_CAMPAIGN, 4)),
stat="identity",
stat_params=list(),
geom="text",
geom_params=list(colour="black", hjust=-2, size=3.5),
position=position_identity()
) +
layer(data=dfb,
mapping=aes(x=Y, y=AVG_CAMPAIGN, label=round(AVG_CAMPAIGN - WINDOW_AVG_CAMPAIGN, 4)),
stat="identity",
stat_params=list(),
geom="text",
geom_params=list(colour="black", hjust=-5, size=3.5),
position=position_identity()
) +
layer(data=dfb,
mapping=aes(yintercept = WINDOW_AVG_CAMPAIGN),
geom="hline",
geom_params=list(colour="red")
)
require("jsonlite")
require("RCurl")
#Gather data from database fill into local data frame and retrieve headers and summary
# Change the USER and PASS below to be your UTEid
df <- data.frame(fromJSON(getURL(URLencode('skipper.cs.utexas.edu:5001/rest/native/?query="select * from BNKMKTG"'),httpheader=c(DB='jdbc:oracle:thin:@sayonara.microlab.cs.utexas.edu:1521:orcl', USER='C##cs329e_rm46926', PASS='orcl_rm46926', MODE='native_mode', MODEL='model', returnDimensions = 'False', returnFor = 'JSON'), verbose = TRUE), ))
head(df)
summary(df)
require(tidyr)
require(dplyr)
require(extrafont)
require(ggplot2)
dfb <- df %>% group_by(POUTCOME, Y) %>% summarise(AVG_CAMPAIGN = mean(CAMPAIGN))
dfb1 <- dfb %>% ungroup %>% group_by(POUTCOME) %>% summarise(WINDOW_AVG_CAMPAIGN = mean(AVG_CAMPAIGN))
dfb <- inner_join(dfb, dfb1, by="POUTCOME")
#spread(dfb, Y, AVG_CAMPAIGN) %>% View
ggplot() +
coord_cartesian() +
scale_x_discrete() +
scale_y_continuous() +
facet_wrap(~POUTCOME, ncol=1) +
labs(title='Portuguese Bank Marketing Campaign Effectiveness\Bar Chart\nAVG_CAMPAIGN, WINDOW_AVG_CAMPAIGN') +
labs(x=paste("Y (OUTCOME)"), y=paste("AVG_CAMPAIGN")) +
layer(data=dfb,
mapping=aes(x=Y, y=AVG_CAMPAIGN, color=Y, fill=Y),
stat="identity",
stat_params=list(),
geom="bar",
geom_params=list(width=.25),
position=position_identity()
) + coord_flip() +
layer(data=dfb,
mapping=aes(x=Y, y=AVG_CAMPAIGN, label=round(AVG_CAMPAIGN, 4)),
stat="identity",
stat_params=list(),
geom="text",
geom_params=list(colour="black", hjust=-0.5, size=3.5),
position=position_identity()
) +
layer(data=dfb,
mapping=aes(x=Y, y=AVG_CAMPAIGN, label=round(WINDOW_AVG_CAMPAIGN, 4)),
stat="identity",
stat_params=list(),
geom="text",
geom_params=list(colour="black", hjust=-2, size=3.5),
position=position_identity()
) +
layer(data=dfb,
mapping=aes(x=Y, y=AVG_CAMPAIGN, label=round(AVG_CAMPAIGN - WINDOW_AVG_CAMPAIGN, 4)),
stat="identity",
stat_params=list(),
geom="text",
geom_params=list(colour="black", hjust=-5, size=3.5),
position=position_identity()
) +
layer(data=dfb,
mapping=aes(yintercept = WINDOW_AVG_CAMPAIGN),
geom="hline",
geom_params=list(colour="red")
)
require(tidyr)
require(dplyr)
require(extrafont)
require(ggplot2)
dfb <- df %>% group_by(POUTCOME, Y) %>% summarise(AVG_CAMPAIGN = mean(CAMPAIGN))
dfb1 <- dfb %>% ungroup %>% group_by(POUTCOME) %>% summarise(WINDOW_AVG_CAMPAIGN = mean(AVG_CAMPAIGN))
dfb <- inner_join(dfb, dfb1, by="POUTCOME")
#spread(dfb, Y, AVG_CAMPAIGN) %>% View
ggplot() +
coord_cartesian() +
scale_x_discrete() +
scale_y_continuous() +
facet_wrap(~POUTCOME, ncol=1) +
labs(title='Portuguese Bank Marketing Campaign Effectiveness\nScatter Plot\nAVG_CAMPAIGN, WINDOW_AVG_CAMPAIGN') +
labs(x=paste("Y (OUTCOME)"), y=paste("AVG_CAMPAIGN")) +
layer(data=dfb,
mapping=aes(x=Y, y=AVG_CAMPAIGN, color=Y, fill=Y),
stat="identity",
stat_params=list(),
geom="bar",
geom_params=list(width=.25),
position=position_identity()
) + coord_flip() +
layer(data=dfb,
mapping=aes(x=Y, y=AVG_CAMPAIGN, label=round(AVG_CAMPAIGN, 4)),
stat="identity",
stat_params=list(),
geom="text",
geom_params=list(colour="black", hjust=-0.5, size=3.5),
position=position_identity()
) +
layer(data=dfb,
mapping=aes(x=Y, y=AVG_CAMPAIGN, label=round(WINDOW_AVG_CAMPAIGN, 4)),
stat="identity",
stat_params=list(),
geom="text",
geom_params=list(colour="black", hjust=-2, size=3.5),
position=position_identity()
) +
layer(data=dfb,
mapping=aes(x=Y, y=AVG_CAMPAIGN, label=round(AVG_CAMPAIGN - WINDOW_AVG_CAMPAIGN, 4)),
stat="identity",
stat_params=list(),
geom="text",
geom_params=list(colour="black", hjust=-5, size=3.5),
position=position_identity()
) +
layer(data=dfb,
mapping=aes(yintercept = WINDOW_AVG_CAMPAIGN),
geom="hline",
geom_params=list(colour="red")
)
require(tidyr)
require(dplyr)
require(extrafont)
require(ggplot2)
dfb <- df %>% group_by(POUTCOME, Y) %>% summarise(AVG_CAMPAIGN = mean(CAMPAIGN))
dfb1 <- dfb %>% ungroup %>% group_by(POUTCOME) %>% summarise(WINDOW_AVG_CAMPAIGN = mean(AVG_CAMPAIGN))
dfb <- inner_join(dfb, dfb1, by="POUTCOME")
#spread(dfb, Y, AVG_CAMPAIGN) %>% View
ggplot() +
coord_cartesian() +
scale_x_discrete() +
scale_y_continuous() +
facet_wrap(~POUTCOME, ncol=1) +
labs(title='Portuguese Bank Marketing Campaign Effectiveness\nBar Chart\nAVG_CAMPAIGN, WINDOW_AVG_CAMPAIGN') +
labs(x=paste("Y (OUTCOME)"), y=paste("AVG_CAMPAIGN")) +
layer(data=dfb,
mapping=aes(x=Y, y=AVG_CAMPAIGN, color=Y, fill=Y),
stat="identity",
stat_params=list(),
geom="bar",
geom_params=list(width=.25),
position=position_identity()
) + coord_flip() +
layer(data=dfb,
mapping=aes(x=Y, y=AVG_CAMPAIGN, label=round(AVG_CAMPAIGN, 4)),
stat="identity",
stat_params=list(),
geom="text",
geom_params=list(colour="black", hjust=-0.5, size=3.5),
position=position_identity()
) +
layer(data=dfb,
mapping=aes(x=Y, y=AVG_CAMPAIGN, label=round(WINDOW_AVG_CAMPAIGN, 4)),
stat="identity",
stat_params=list(),
geom="text",
geom_params=list(colour="black", hjust=-2, size=3.5),
position=position_identity()
) +
layer(data=dfb,
mapping=aes(x=Y, y=AVG_CAMPAIGN, label=round(AVG_CAMPAIGN - WINDOW_AVG_CAMPAIGN, 4)),
stat="identity",
stat_params=list(),
geom="text",
geom_params=list(colour="black", hjust=-5, size=3.5),
position=position_identity()
) +
layer(data=dfb,
mapping=aes(yintercept = WINDOW_AVG_CAMPAIGN),
geom="hline",
geom_params=list(colour="red")
)
require("jsonlite")
require("RCurl")
#Gather data from database fill into local data frame and retrieve headers and summary
# Change the USER and PASS below to be your UTEid
df <- data.frame(fromJSON(getURL(URLencode('skipper.cs.utexas.edu:5001/rest/native/?query="select * from BNKMKTG"'),httpheader=c(DB='jdbc:oracle:thin:@sayonara.microlab.cs.utexas.edu:1521:orcl', USER='C##cs329e_rm46926', PASS='orcl_rm46926', MODE='native_mode', MODEL='model', returnDimensions = 'False', returnFor = 'JSON'), verbose = TRUE), ))
head(df)
summary(df)
require("jsonlite")
require("RCurl")
require(ggplot2)
require(dplyr)
KPI_Low_Max_value = .1
KPI_Medium_Max_value = .15
df %>% group_by(JOB) %>% summarize() %>% View()
#stuck on the mutate not sure how to get just yes and just no to do the ratio
#Maybe erade everything and start from scratch again for this file??
dfc <- df %>% mutate(Yyes = ifelse(Y == 'yes', 1, 0), Yno = ifelse(Y == 'no', 1, 0)) %>% group_by(EDUCATION) %>% mutate(Ratio = sum(Yyes)/sum(Yno)) %>% ungroup() %>% group_by(EDUCATION, Y, HOUSING) %>% summarize(AVG_DURATION = round(mean(DURATION),1), Ratio = mean(Ratio)) %>% mutate(KPI = ifelse(Ratio <= KPI_Low_Max_value, '03 Low', ifelse(Ratio <= KPI_Medium_Max_value, '02 Medium', '01 High')))
spread(dfc, Y, AVG_DURATION) %>% View
dfc$EDUCATION <- factor(dfc$EDUCATION, levels = c("illiterate", "basic4y", "basic6y", "basic9y", "highschool", "universitydegree", "professionalcourse", "unknown"))
ggplot() +
coord_cartesian() +
scale_x_discrete() +
scale_y_discrete() +
scale_fill_manual(values = c("green","yellow","red")) +
facet_grid(.~EDUCATION) +
labs(title='Portuguese Bank Marketing Campaign Effectiveness\nCrosstab\nAVG_DURATION') +
labs(x=paste("EDUCATION/Y"), y=paste("HOUSING")) +
layer(data=dfc,
mapping=aes(x=Y, y=HOUSING, label=AVG_DURATION),
stat="identity",
stat_params=list(),
geom="text",
geom_params=list(colour="black"),
position=position_identity()
) +
layer(data=dfc,
mapping=aes(x=Y, y=HOUSING, fill=KPI),
stat="identity",
stat_params=list(),
geom="tile",
geom_params=list(alpha=0.50),
position=position_identity()
)
require("jsonlite")
require("RCurl")
require(ggplot2)
require(dplyr)
KPI_Low_Max_value = .1
KPI_Medium_Max_value = .15
df %>% group_by(JOB) %>% summarize() %>% View()
#stuck on the mutate not sure how to get just yes and just no to do the ratio
#Maybe erade everything and start from scratch again for this file??
dfc <- df %>% mutate(Yyes = ifelse(Y == 'yes', 1, 0), Yno = ifelse(Y == 'no', 1, 0)) %>% group_by(EDUCATION) %>% mutate(Ratio = sum(Yyes)/sum(Yno)) %>% ungroup() %>% group_by(EDUCATION, Y, HOUSING) %>% summarize(AVG_DURATION = round(mean(DURATION),1), Ratio = mean(Ratio)) %>% mutate(KPI = ifelse(Ratio <= KPI_Low_Max_value, '03 Low', ifelse(Ratio <= KPI_Medium_Max_value, '02 Medium', '01 High')))
spread(dfc, Y, AVG_DURATION) %>% View
dfc$EDUCATION <- factor(dfc$EDUCATION, levels = c("illiterate", "basic4y", "basic6y", "basic9y", "highschool", "universitydegree", "professionalcourse", "unknown"))
ggplot() +
coord_cartesian() +
scale_x_discrete() +
scale_y_discrete() +
scale_fill_manual(values = c("green","yellow","red")) +
facet_grid(.~EDUCATION) +
labs(title='Portuguese Bank Marketing Campaign Effectiveness\nCrosstab\nAVG_DURATION') +
labs(x=paste("EDUCATION/Y"), y=paste("HOUSING")) +
layer(data=dfc,
mapping=aes(x=Y, y=HOUSING, label=AVG_DURATION),
stat="identity",
stat_params=list(),
geom="text",
geom_params=list(colour="black", size=4),
position=position_identity()
) +
layer(data=dfc,
mapping=aes(x=Y, y=HOUSING, fill=KPI),
stat="identity",
stat_params=list(),
geom="tile",
geom_params=list(alpha=0.50),
position=position_identity()
)
require("jsonlite")
require("RCurl")
require(ggplot2)
require(dplyr)
KPI_Low_Max_value = .1
KPI_Medium_Max_value = .15
df %>% group_by(JOB) %>% summarize() %>% View()
#stuck on the mutate not sure how to get just yes and just no to do the ratio
#Maybe erade everything and start from scratch again for this file??
dfc <- df %>% mutate(Yyes = ifelse(Y == 'yes', 1, 0), Yno = ifelse(Y == 'no', 1, 0)) %>% group_by(EDUCATION) %>% mutate(Ratio = sum(Yyes)/sum(Yno)) %>% ungroup() %>% group_by(EDUCATION, Y, HOUSING) %>% summarize(AVG_DURATION = round(mean(DURATION),1), Ratio = mean(Ratio)) %>% mutate(KPI = ifelse(Ratio <= KPI_Low_Max_value, '03 Low', ifelse(Ratio <= KPI_Medium_Max_value, '02 Medium', '01 High')))
spread(dfc, Y, AVG_DURATION) %>% View
dfc$EDUCATION <- factor(dfc$EDUCATION, levels = c("illiterate", "basic4y", "basic6y", "basic9y", "highschool", "universitydegree", "professionalcourse", "unknown"))
ggplot() +
coord_cartesian() +
scale_x_discrete() +
scale_y_discrete() +
scale_fill_manual(values = c("green","yellow","red")) +
facet_grid(.~EDUCATION) +
labs(title='Portuguese Bank Marketing Campaign Effectiveness\nCrosstab\nAVG_DURATION') +
labs(x=paste("EDUCATION/Y"), y=paste("HOUSING")) +
layer(data=dfc,
mapping=aes(x=Y, y=HOUSING, label=AVG_DURATION),
stat="identity",
stat_params=list(),
geom="text",
geom_params=list(colour="black", size=2),
position=position_identity()
) +
layer(data=dfc,
mapping=aes(x=Y, y=HOUSING, fill=KPI),
stat="identity",
stat_params=list(),
geom="tile",
geom_params=list(alpha=0.50),
position=position_identity()
)
require("jsonlite")
require("RCurl")
require(ggplot2)
require(dplyr)
KPI_Low_Max_value = .1
KPI_Medium_Max_value = .15
df %>% group_by(JOB) %>% summarize() %>% View()
#stuck on the mutate not sure how to get just yes and just no to do the ratio
#Maybe erade everything and start from scratch again for this file??
dfc <- df %>% mutate(Yyes = ifelse(Y == 'yes', 1, 0), Yno = ifelse(Y == 'no', 1, 0)) %>% group_by(EDUCATION) %>% mutate(Ratio = sum(Yyes)/sum(Yno)) %>% ungroup() %>% group_by(EDUCATION, Y, HOUSING) %>% summarize(AVG_DURATION = round(mean(DURATION),1), Ratio = mean(Ratio)) %>% mutate(KPI = ifelse(Ratio <= KPI_Low_Max_value, '03 Low', ifelse(Ratio <= KPI_Medium_Max_value, '02 Medium', '01 High')))
spread(dfc, Y, AVG_DURATION) %>% View
dfc$EDUCATION <- factor(dfc$EDUCATION, levels = c("illiterate", "basic4y", "basic6y", "basic9y", "highschool", "universitydegree", "professionalcourse", "unknown"))
ggplot() +
coord_cartesian() +
scale_x_discrete() +
scale_y_discrete() +
scale_fill_manual(values = c("green","yellow","red")) +
facet_grid(.~EDUCATION) +
labs(title='Portuguese Bank Marketing Campaign Effectiveness\nCrosstab\nAVG_DURATION') +
labs(x=paste("EDUCATION/Y"), y=paste("HOUSING")) +
layer(data=dfc,
mapping=aes(x=Y, y=HOUSING, label=AVG_DURATION),
stat="identity",
stat_params=list(),
geom="text",
geom_params=list(colour="black", size=3),
position=position_identity()
) +
layer(data=dfc,
mapping=aes(x=Y, y=HOUSING, fill=KPI),
stat="identity",
stat_params=list(),
geom="tile",
geom_params=list(alpha=0.50),
position=position_identity()
)
require("jsonlite")
require("RCurl")
require(ggplot2)
require(dplyr)
KPI_Low_Max_value = .1
KPI_Medium_Max_value = .15
df %>% group_by(JOB) %>% summarize() %>% View()
#stuck on the mutate not sure how to get just yes and just no to do the ratio
#Maybe erade everything and start from scratch again for this file??
dfc <- df %>% mutate(Yyes = ifelse(Y == 'yes', 1, 0), Yno = ifelse(Y == 'no', 1, 0)) %>% group_by(EDUCATION) %>% mutate(Ratio = sum(Yyes)/sum(Yno)) %>% ungroup() %>% group_by(EDUCATION, Y, HOUSING) %>% summarize(AVG_DURATION = round(mean(DURATION),1), Ratio = mean(Ratio)) %>% mutate(KPI = ifelse(Ratio <= KPI_Low_Max_value, '03 Low', ifelse(Ratio <= KPI_Medium_Max_value, '02 Medium', '01 High')))
spread(dfc, Y, AVG_DURATION) %>% View
dfc$EDUCATION <- factor(dfc$EDUCATION, levels = c("illiterate", "basic4y", "basic6y", "basic9y", "highschool", "universitydegree", "professionalcourse", "unknown"))
ggplot() +
coord_cartesian() +
scale_x_discrete() +
scale_y_discrete() +
scale_fill_manual(values = c("green","yellow","red")) +
facet_grid(.~EDUCATION) +
labs(title='Portuguese Bank Marketing Campaign Effectiveness\nCrosstab\nAVG_DURATION') +
labs(x=paste("EDUCATION/Y"), y=paste("HOUSING")) +
layer(data=dfc,
mapping=aes(x=Y, y=HOUSING, label=AVG_DURATION),
stat="identity",
stat_params=list(),
geom="text",
geom_params=list(colour=KPI, size=3),
position=position_identity()
) +
layer(data=dfc,
mapping=aes(x=Y, y=HOUSING, fill=KPI),
stat="identity",
stat_params=list(),
geom="tile",
geom_params=list(alpha=0.50),
position=position_identity()
)
require("jsonlite")
require("RCurl")
require(ggplot2)
require(dplyr)
KPI_Low_Max_value = .1
KPI_Medium_Max_value = .15
df %>% group_by(JOB) %>% summarize() %>% View()
#stuck on the mutate not sure how to get just yes and just no to do the ratio
#Maybe erade everything and start from scratch again for this file??
dfc <- df %>% mutate(Yyes = ifelse(Y == 'yes', 1, 0), Yno = ifelse(Y == 'no', 1, 0)) %>% group_by(EDUCATION) %>% mutate(Ratio = sum(Yyes)/sum(Yno)) %>% ungroup() %>% group_by(EDUCATION, Y, HOUSING) %>% summarize(AVG_DURATION = round(mean(DURATION),1), Ratio = mean(Ratio)) %>% mutate(KPI = ifelse(Ratio <= KPI_Low_Max_value, '03 Low', ifelse(Ratio <= KPI_Medium_Max_value, '02 Medium', '01 High')))
spread(dfc, Y, AVG_DURATION) %>% View
dfc$EDUCATION <- factor(dfc$EDUCATION, levels = c("illiterate", "basic4y", "basic6y", "basic9y", "highschool", "universitydegree", "professionalcourse", "unknown"))
ggplot() +
coord_cartesian() +
scale_x_discrete() +
scale_y_discrete() +
scale_fill_manual(values = c("green","yellow","red")) +
facet_grid(.~EDUCATION) +
labs(title='Portuguese Bank Marketing Campaign Effectiveness\nCrosstab\nAVG_DURATION') +
labs(x=paste("EDUCATION/Y"), y=paste("HOUSING")) +
layer(data=dfc,
mapping=aes(x=Y, y=HOUSING, label=AVG_DURATION, color=KPI),
stat="identity",
stat_params=list(),
geom="text",
geom_params=list(size=3),
position=position_identity()
) +
layer(data=dfc,
mapping=aes(x=Y, y=HOUSING, fill=KPI),
stat="identity",
stat_params=list(),
geom="tile",
geom_params=list(alpha=0.50),
position=position_identity()
)
require("jsonlite")
require("RCurl")
require(ggplot2)
require(dplyr)
KPI_Low_Max_value = .1
KPI_Medium_Max_value = .15
df %>% group_by(JOB) %>% summarize() %>% View()
#stuck on the mutate not sure how to get just yes and just no to do the ratio
#Maybe erade everything and start from scratch again for this file??
dfc <- df %>% mutate(Yyes = ifelse(Y == 'yes', 1, 0), Yno = ifelse(Y == 'no', 1, 0)) %>% group_by(EDUCATION) %>% mutate(Ratio = sum(Yyes)/sum(Yno)) %>% ungroup() %>% group_by(EDUCATION, Y, HOUSING) %>% summarize(AVG_DURATION = round(mean(DURATION),1), Ratio = mean(Ratio)) %>% mutate(KPI = ifelse(Ratio <= KPI_Low_Max_value, '03 Low', ifelse(Ratio <= KPI_Medium_Max_value, '02 Medium', '01 High')))
spread(dfc, Y, AVG_DURATION) %>% View
dfc$EDUCATION <- factor(dfc$EDUCATION, levels = c("illiterate", "basic4y", "basic6y", "basic9y", "highschool", "universitydegree", "professionalcourse", "unknown"))
ggplot() +
coord_cartesian() +
scale_x_discrete() +
scale_y_discrete() +
scale_fill_manual(values = c("green","yellow","red")) +
facet_grid(.~EDUCATION) +
labs(title='Portuguese Bank Marketing Campaign Effectiveness\nCrosstab\nAVG_DURATION') +
labs(x=paste("EDUCATION/Y"), y=paste("HOUSING")) +
layer(data=dfc,
mapping=aes(x=Y, y=HOUSING, label=AVG_DURATION),
stat="identity",
stat_params=list(),
geom="text",
geom_params=list(colour="black", size=3.2),
position=position_identity()
) +
layer(data=dfc,
mapping=aes(x=Y, y=HOUSING, fill=KPI),
stat="identity",
stat_params=list(),
geom="tile",
geom_params=list(alpha=0.50),
position=position_identity()
)
require("jsonlite")
require("RCurl")
require(ggplot2)
require(dplyr)
KPI_Low_Max_value = .1
KPI_Medium_Max_value = .15
df %>% group_by(JOB) %>% summarize() %>% View()
#stuck on the mutate not sure how to get just yes and just no to do the ratio
#Maybe erade everything and start from scratch again for this file??
dfc <- df %>% mutate(Yyes = ifelse(Y == 'yes', 1, 0), Yno = ifelse(Y == 'no', 1, 0)) %>% group_by(EDUCATION) %>% mutate(Ratio = sum(Yyes)/sum(Yno)) %>% ungroup() %>% group_by(EDUCATION, Y, HOUSING) %>% summarize(AVG_DURATION = round(mean(DURATION),1), Ratio = mean(Ratio)) %>% mutate(KPI = ifelse(Ratio <= KPI_Low_Max_value, '03 Low', ifelse(Ratio <= KPI_Medium_Max_value, '02 Medium', '01 High')))
spread(dfc, Y, AVG_DURATION) %>% View
dfc$EDUCATION <- factor(dfc$EDUCATION, levels = c("illiterate", "basic4y", "basic6y", "basic9y", "highschool", "universitydegree", "professionalcourse", "unknown"))
ggplot() +
coord_cartesian() +
scale_x_discrete() +
scale_y_discrete() +
scale_fill_manual(values = c("green","yellow","red")) +
facet_grid(.~EDUCATION) +
labs(title='Portuguese Bank Marketing Campaign Effectiveness\nCrosstab\nAVG_DURATION') +
labs(x=paste("EDUCATION/Y"), y=paste("HOUSING")) +
layer(data=dfc,
mapping=aes(x=Y, y=HOUSING, label=AVG_DURATION),
stat="identity",
stat_params=list(),
geom="text",
geom_params=list(colour="black", size=2.8),
position=position_identity()
) +
layer(data=dfc,
mapping=aes(x=Y, y=HOUSING, fill=KPI),
stat="identity",
stat_params=list(),
geom="tile",
geom_params=list(alpha=0.50),
position=position_identity()
)
